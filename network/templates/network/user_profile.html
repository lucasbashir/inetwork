{% extends "network/layout.html" %}
{% load static %}
{% load my_filters %}
{% block body %}

<div style="color:black;" class="container-fluid">
  <div class="row mb-3">
    <div class="col-6 text-center">
      <h5 class="text-white">Following: {{ following.count }}</h5>
    </div>
    <div class="col-6 text-center">
      <h5 class="text-white">Followers: {{ follower.count }}</h5>
    </div>
  </div>
  {% if user.is_authenticated %}
    {% if user != userProfile %}
      {% if isFollowing %}
      <form action="{% url 'unfollow' %}" method="post">
        {% csrf_token %}
        <input type="hidden" name="followUser" value="{{ userProfile }}" />
        <button class="btn btn-primary w-100" style="background-color: #dc3545; border-color: #dc3545;">
          <i class="fas fa-user-minus"></i> Unfollow
        </button>
      </form>
    {% else %}
      <form action="{% url 'follow' %}" method="post">
        {% csrf_token %}
        <input type="hidden" name="followUser" value="{{ userProfile }}" />
        <button class="btn btn-primary w-100">
          <i class="fas fa-user-plus"></i> Follow
        </button>
      </form>
      {% endif %}
        {% endif %}
          {% endif %}
</div>


{% for posts in page_post %}

<div class="card">
    <div class="card-body">
      <a href="{% url 'profile' user_id=posts.user.id %}">
        <img src="{{ posts.user.profile_pics.url }}" class="rounded-circle" width="50" height="50">
      </a>

        <!-- Display a link to the user's profile -->
        <a class="card-title" href="{% url 'profile' user_id=posts.user.id %}">@{{posts.user}}</a>
        <br>
        <br>
        <!-- Display the content of the post -->
        <div class="card-text" id="content_{{ posts.id }}">
          {% for paragraph in posts.postContent|split_paragraphs %}
  {% if forloop.counter <= 10 %}
    <p>{{ paragraph|urlize }}</p>
  {% endif %}
{% endfor %}
{% if posts.postContent|split_paragraphs|length > 2 %}
<a href="{% url 'post_content' post_id=posts.id %}">
  <p class="btn btn-link read-more" data-post="{{ posts.id }}">Read full content >>></p>
</a>
{% endif %}

        </div>
        {% if posts.post_image %}
        <div class="post-image-container">
          <img src="{{ posts.post_image.url }}" alt="Post image">
        </div>
{% endif %}
    </div>
</div>
<p class="card-text"><small class="text-muted">{{ posts.timestamp }}</small></p>

<!-- Display the number of likes for the post -->
{% include 'network/likes.html' %}

<!--Urlize comments, read more commets and display comments-->
{% include 'network/comments.html' %}
  <!-- End of the for loop -->
  {% endfor %}

      <!-- Pagination for navigating through the posts -->
      <nav aria-label="Page navigation example">
      <ul class="pagination d-flex justify-content-center">
      {% if page_post.has_previous %}
      <!-- If there is a previous page, display a "previous" button -->
      <li class="page-item"><a class="page-link" href="?page={{page_post.previous_page_number}}">Previous</a></li>
      {% endif %}
      {% if page_post.has_next %}
      <!-- If there is a next page, display a "next" button -->
      <li class="page-item"><a class="page-link" href="?page={{page_post.next_page_number}}">Next</a></li>
      {% endif %}
      </ul>
      </nav>

{% endblock %}